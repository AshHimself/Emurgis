<template name="documentShow">

  <div class="document-show">
    <div class="card">
      <div class="card-body">
        {{#if Template.subscriptionsReady}}
          <div class="float-right">
            {{{claimButton problem}}}
            {{{watchButton problem}}}
            {{#if problem.claimed}}
              {{#if hasClaimedProblem problem.claimedBy}}
                {{{ markAsResolved problem }}}
              {{/if}}
            {{/if}}
            {{#if isProblemOwner problem.createdBy}}
            <a class="btn btn-sm btn-secondary" href="{{pathFor 'documentEdit' documentId=problem._id}}" role="button">Edit</a>
        		<a class="btn btn-sm btn-danger js-delete-document" href="#" role="button">Delete</a>
            {{{statusButton problem}}}
            {{/if}}
          </div>

          <h3>{{problem.summary}}</h3>
          <div class="card-subtitle">
            {{{statusText problem.status}}}
          </div>
          <br/>
          <h5 class="card-subtitle">Problem</h5>
          <p class="card-text font-weight-normal">{{problem.description}}</p>
          <br/>
          <h5 class="card-subtitle">Solution</h5>
          <p class="card-text font-weight-normal">{{problem.solution}}</p>
          <hr>
          <p class="text-muted" style="margin:0">
            <strong>{{getNameById problem.createdBy}}</strong> created this {{showTimeAgoTimestamp problem.createdAt}} <br/>

            {{#if problem.updatedAt}}
              Updated: {{showTimeAgoTimestamp problem.updatedAt}}<br>
            {{/if}}
          {{#if problem.claimed}}
          Claimed by <strong>{{problem.claimedFullname}}</strong> {{showTimeAgoTimestamp problem.claimedDateTime}} <br />
          {{/if}}
          {{#if problem.resolved}}
            Resolved by <strong>{{resolvedByUser problem}}</strong> {{showTimeAgoTimestamp problem.resolvedDateTime}} <br>
          {{/if}}
          </p>
        {{else}}
          {{> loader}}
        {{/if}}
      </div>
    </div>

    <div class="card">
      <div class="card-body">
        <p class="card-text">{{problem.description}}</p>

        <h6 class="card-subtitle text-muted">Solution:</h6>
        <p class="card-text">{{problem.solution}}</p>
      </div>
    </div>
  </div>

{{#each comment in comments}}
  {{> documentComments comment=comment}}
{{/each}}

      <div class="document-show pb-4">
        <div class="card">
            <div class="card-body">
                <div class="form-group">
                    <textarea class="form-control" id="comments" name="comment" rows="3" required></textarea>
                </div>
                <p class="text-danger">{{ commentInvalidMessage }}</p>
                <button type="submit" class="btn btn-primary mb-2 documentCommentBtn">Comment</button>
            </div>
        </div>
    </div>
</template>
